2025-06-20 18:20:37,031 - INFO - Fetching data from 2023-01-01 to 2023-12-31...
start date 2023-01-01
2025-06-20 18:20:37,032 - INFO - Starting data fetch process
2025-06-20 18:20:37,032 - INFO - Processing ETHUSDT...
2025-06-20 18:20:37,032 - INFO - Fetching klines for ETHUSDT (interval: 8h)
2025-06-20 18:20:37,032 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:38,698 - INFO - [ETHUSDT] No more data available
2025-06-20 18:20:38,698 - INFO - [ETHUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:38,709 - INFO - Fetching funding rates for ETHUSDT
2025-06-20 18:20:40,394 - INFO - [ETHUSDT] No more funding data available
2025-06-20 18:20:40,396 - INFO - [ETHUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:40,405 - INFO - ✓ ETHUSDT completed successfully
2025-06-20 18:20:40,405 - INFO - Processing BNBUSDT...
2025-06-20 18:20:40,406 - INFO - Fetching klines for BNBUSDT (interval: 8h)
2025-06-20 18:20:40,406 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:41,971 - INFO - [BNBUSDT] No more data available
2025-06-20 18:20:41,972 - INFO - [BNBUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:41,978 - INFO - Fetching funding rates for BNBUSDT
2025-06-20 18:20:43,543 - INFO - [BNBUSDT] No more funding data available
2025-06-20 18:20:43,544 - INFO - [BNBUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:43,548 - INFO - ✓ BNBUSDT completed successfully
2025-06-20 18:20:43,548 - INFO - Processing XRPUSDT...
2025-06-20 18:20:43,548 - INFO - Fetching klines for XRPUSDT (interval: 8h)
2025-06-20 18:20:43,549 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:45,117 - INFO - [XRPUSDT] No more data available
2025-06-20 18:20:45,118 - INFO - [XRPUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:45,123 - INFO - Fetching funding rates for XRPUSDT
2025-06-20 18:20:46,843 - INFO - [XRPUSDT] No more funding data available
2025-06-20 18:20:46,844 - INFO - [XRPUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:46,849 - INFO - ✓ XRPUSDT completed successfully
2025-06-20 18:20:46,849 - INFO - Processing ADAUSDT...
2025-06-20 18:20:46,849 - INFO - Fetching klines for ADAUSDT (interval: 8h)
2025-06-20 18:20:46,849 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:48,540 - INFO - [ADAUSDT] No more data available
2025-06-20 18:20:48,540 - INFO - [ADAUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:48,547 - INFO - Fetching funding rates for ADAUSDT
2025-06-20 18:20:50,375 - INFO - [ADAUSDT] No more funding data available
2025-06-20 18:20:50,377 - INFO - [ADAUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:50,383 - INFO - ✓ ADAUSDT completed successfully
2025-06-20 18:20:50,383 - INFO - Processing SOLUSDT...
2025-06-20 18:20:50,383 - INFO - Fetching klines for SOLUSDT (interval: 8h)
2025-06-20 18:20:50,383 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:52,085 - INFO - [SOLUSDT] No more data available
2025-06-20 18:20:52,085 - INFO - [SOLUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:52,090 - INFO - Fetching funding rates for SOLUSDT
2025-06-20 18:20:53,785 - INFO - [SOLUSDT] No more funding data available
2025-06-20 18:20:53,786 - INFO - [SOLUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:53,791 - INFO - ✓ SOLUSDT completed successfully
2025-06-20 18:20:53,791 - INFO - Processing BTCUSDT...
2025-06-20 18:20:53,792 - INFO - Fetching klines for BTCUSDT (interval: 8h)
2025-06-20 18:20:53,792 - INFO - Date range: 2023-01-01 to 2023-12-31
2025-06-20 18:20:55,473 - INFO - [BTCUSDT] No more data available
2025-06-20 18:20:55,473 - INFO - [BTCUSDT] Successfully fetched 1095 klines
2025-06-20 18:20:55,479 - INFO - Fetching funding rates for BTCUSDT
2025-06-20 18:20:57,173 - INFO - [BTCUSDT] No more funding data available
2025-06-20 18:20:57,174 - INFO - [BTCUSDT] Successfully fetched 1095 funding rates
2025-06-20 18:20:57,181 - INFO - ✓ BTCUSDT completed successfully
2025-06-20 18:20:57,182 - INFO - Merging price data...
2025-06-20 18:20:57,189 - INFO - Merging funding data...
2025-06-20 18:20:57,193 - INFO - Combining price and funding data...
2025-06-20 18:20:57,195 - INFO - Final dataset shape: (690, 13)
2025-06-20 18:20:57,195 - INFO - Data fetch process completed successfully
2025-06-20 18:20:57,195 - INFO - Raw data loaded | shape=(690, 13)
2025-06-20 18:20:57,213 - INFO - Logging sample rows to W&B...
2025-06-20 18:20:57,855 - INFO - Logging summary stats to W&B...
2025-06-20 18:20:57,878 - ERROR - Data load step failed
Traceback (most recent call last):
  File "/Users/aviv/Library/Mobile Documents/com~apple~CloudDocs/study/MLOps_Group_Project/src/mlops/data_load/run.py", line 73, in run_data_load
    stats_tbl = wandb.Table(dataframe=stats_df)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table.py", line 275, in __init__
    self._init_from_dataframe(dataframe, columns, optional, dtype)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table.py", line 337, in _init_from_dataframe
    self.add_data(*tuple(dataframe[col].values[row] for col in self.columns))
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table_decorators.py", line 42, in wrapper
    return method(self, *args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table_decorators.py", line 58, in wrapper
    res = method(self, *args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table.py", line 529, in add_data
    result_type = self._get_updated_result_type(data)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/wandb/sdk/data_types/table.py", line 553, in _get_updated_result_type
    raise TypeError(
        f"Data row contained incompatible types:\n{current_type.explain(incoming_row_dict)}"
    )
TypeError: Data row contained incompatible types:
{'index': 'ETHUSDT_price', 'count': 690.0, 'mean': 1825.9864057971017, 'min': 1195.06, '25%': 1643.7425, '50%': 1831.95, '75%': 1917.44, 'max': 2383.1, 'std': 225.64431546318878} of type {'index': String, 'count': Number, 'mean': Number, 'min': Number, '25%': Number, '50%': Number, '75%': Number, 'max': Number, 'std': Number} is not assignable to {'index': None or String, 'count': None or Number, 'mean': None or Pythonobject(class_name:Timestamp), 'min': None or Pythonobject(class_name:Timestamp), '25%': None or Pythonobject(class_name:Timestamp), '50%': None or Pythonobject(class_name:Timestamp), '75%': None or Pythonobject(class_name:Timestamp), 'max': None or Pythonobject(class_name:Timestamp), 'std': None or Unknown}
Key 'mean':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
Key 'min':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
Key '25%':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
Key '50%':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
Key '75%':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
Key 'max':
	Number not assignable to None or Pythonobject(class_name:Timestamp)
		Number not assignable to None
	and
		Number not assignable to Pythonobject(class_name:Timestamp)
