2025-06-20 15:15:32,528 - __main__ - INFO - Loading new data for inference from: data/raw/test.csv
2025-06-20 15:15:32,535 - __main__ - INFO - Initializing ModelInferencer and generating predictions...
2025-06-20 15:15:32,536 - src.mlops.inference.inference - INFO - Model loaded from models/linear_regression.pkl
2025-06-20 15:15:32,536 - src.mlops.inference.inference - INFO - Model loaded from models/logistic_regression.pkl
2025-06-20 15:15:32,536 - src.mlops.inference.inference - INFO - Both models loaded successfully for inference
2025-06-20 15:15:32,536 - src.mlops.inference.inference - INFO - Preprocessing pipeline loaded from models/preprocessing_pipeline.pkl
[define_features_and_label] Features: ['ETHUSDT_price', 'BNBUSDT_price', 'XRPUSDT_price', 'ADAUSDT_price', 'SOLUSDT_price', 'ETHUSDT_funding_rate', 'BNBUSDT_funding_rate', 'XRPUSDT_funding_rate', 'ADAUSDT_funding_rate', 'SOLUSDT_funding_rate', 'BTCUSDT_funding_rate']
[define_features_and_label] Label: BTCUSDT_price
2025-06-20 15:15:32,542 - src.mlops.inference.inference - INFO - Input preprocessed. Reg features: (6, 9), Class features: (6, 6)
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
  warnings.warn(
2025-06-20 15:15:32,543 - src.mlops.inference.inference - INFO - Generated 6 price predictions
[define_features_and_label] Features: ['ETHUSDT_price', 'BNBUSDT_price', 'XRPUSDT_price', 'ADAUSDT_price', 'SOLUSDT_price', 'ETHUSDT_funding_rate', 'BNBUSDT_funding_rate', 'XRPUSDT_funding_rate', 'ADAUSDT_funding_rate', 'SOLUSDT_funding_rate', 'BTCUSDT_funding_rate']
[define_features_and_label] Label: BTCUSDT_price
2025-06-20 15:15:32,544 - src.mlops.inference.inference - INFO - Input preprocessed. Reg features: (6, 9), Class features: (6, 6)
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sklearn/utils/validation.py:2739: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
2025-06-20 15:15:32,545 - src.mlops.inference.inference - INFO - Generated 6 direction predictions
2025-06-20 15:15:32,545 - src.mlops.inference.inference - INFO - Generated both price and direction predictions
2025-06-20 15:15:32,546 - __main__ - INFO - Inference complete. Shape of predictions: (6, 16)
2025-06-20 15:15:32,548 - __main__ - INFO - Predictions saved to: data/processed/predictions.csv
2025-06-20 15:15:33,024 - __main__ - INFO - Generating and logging visualizations...
2025-06-20 15:15:33,026 - __main__ - ERROR - Inference step failed
Traceback (most recent call last):
  File "/Users/aviv/Library/Mobile Documents/com~apple~CloudDocs/study/MLOps_Group_Project/src/mlops/inference/run.py", line 92, in run_inference
    plt.figure(figsize=(10, 6))
    ^^^
NameError: name 'plt' is not defined
